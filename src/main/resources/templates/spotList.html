{{#partial "head"}}

{{/partial}}

{{#partial "contents"}}
<style>
.title {
	font-size: 20px;
	font-weight: bold;
	text-overflow: ellipsis;
	white-space: nowrap;
	overflow: hidden;
}
.spotContainer {
	display: inline-block;
	margin-bottom: 20px;
	margin-right: 10px;
	width: 250px;
	height: 250px;
}
#container {
	width: 1080px;
	margin: 0 auto;
	margin-bottom: 100px;
	padding-left: 25px;
}
.img {
	width: 250px;
}
.absolute {
	position: absolute;
}
.relative {
	position: relative;
}
.star {
	top: 5px;
	left: 220px;
}
.contentContainer {
	top: 170px;
	position: relative;
}
.likeCnt img{
	width: 16px;
	vertical-align: baseline;
}
</style>
<div id="container">
{{#spots}}
<div class="spotContainer">
	
	<div class="imgContainer">
	{{#imgUrl}}
		{{#if @first}}
		<div class="absolute">
			<div class="relative">
				<img src="{{this}}" alt="" class="img"/>
			</div>
		</div>
		<div class="absolute">
			<div class="relative star">
				{{#if isLike}}
					<img src="/image/fullStar.png" alt="" onclick="switchStarImg(this)" data-id="{{id}}"/>
				{{else}}
					<img src="/image/star.png" alt="" onclick="switchStarImg(this)" data-id="{{id}}"/>
				{{/if}}
			</div>
		</div>
		{{/if}}
	{{/imgUrl}}	
	</div>
	<div class="contentContainer">
	<!-- 카테고리/타이틀/좋아요수 -->
	<div>{{category}}</div>
	<div class="title">{{name}}</div>
	<div class="likeCnt"> 
		<img src="/image/fullStar.png" alt="" />
		<span>{{likeCnt}}</span>
	</div>
	</div>
</div>
{{/spots}}
</div>

<script>
function switchStarImg(img) {
	
	var imgCnt = img.parentElement.parentElement.parentElement.parentElement.children[1].children[2].children[1];
	console.log(imgCnt);
	if(img.getAttribute("src") === '/image/star.png') {
		$.ajax({
			url: '/api/spots/'+img.dataset.id+"/spotLike",
			type: 'post',
			success: function(data) {
				img.setAttribute("src", '/image/fullStar.png');
				imgCnt.innerHTML = data;
			},
			error: function(XMLHttpRequest, textStatus, errorThrown) {
				console.log("Status: " + textStatus); 
				console.log("Error: " + errorThrown); 
			}
		});
	} else {
		$.ajax({
			url: '/api/spots/'+img.dataset.id+"/spotLike",
			type: 'delete',
			success: function(data) {
				img.setAttribute("src", '/image/star.png');
				imgCnt.innerHTML = data;
			},
			error: function(XMLHttpRequest, textStatus, errorThrown) {
				console.log("Status: " + textStatus); 
				console.log("Error: " + errorThrown); 
			}
		});
	}
	
}

</script>

    
{{/partial}}

{{#partial "script"}}
{{/partial}}

{{>base}}